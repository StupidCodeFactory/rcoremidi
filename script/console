#!/usr/bin/env ruby
require 'irb'
# require 'irb/rubinius'

require "bundler/setup"
require 'byebug'
require 'ap'
Bundler.setup :default

require 'rcoremidi'





device = RCoreMidi::Device.all.last
puts device.name
destination = device.entities.first.endpoints.detect { |e| e.is_a? RCoreMidi::Destination }

source      = RCoreMidi::Device.all.last.entities.first.endpoints.detect { |e| e.is_a? RCoreMidi::Source }

client = RCoreMidi::Client.new("Bob", 180)

client.connect_to source

instruments_dir = File.join(File.dirname(__FILE__), 'instruments')
client.live destination, instruments_dir do

   # instrument 'drum', 0
  instrument 'bass', 1
end

client.start
